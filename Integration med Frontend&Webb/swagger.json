{
  "openapi": "3.0.0",
  "info": {
    "title": "Backend API Documentation",
    "version": "1.2.1",
    "description": "API för autentisering, användare, företag, paket, IoT och sensorsystem (inkl. telemetri)."
  },
  "servers": [
    {
      "url": "https://backendgruppii.azurewebsites.net",
      "description": "Azure Production"
    },
    {
      "url": "http://localhost:3000",
      "description": "Lokal utveckling"
    }
  ],
  "tags": [
    { "name": "System" },
    { "name": "Secure" },
    { "name": "Admin" },
    { "name": "Auth" },
    { "name": "Companies" },
    { "name": "IoT" },
    { "name": "Packages" },
    { "name": "Users" }
  ],
  "paths": {
    "/health": {
      "get": {
        "tags": ["System"],
        "summary": "Healthcheck",
        "responses": {
          "200": {
            "description": "Status OK"
          }
        }
      }
    },

    "/api/secure/ping": {
      "get": {
        "tags": ["Secure"],
        "summary": "Ping som i framtiden kräver JWT",
        "responses": {
          "200": {
            "description": "Secure ping OK (mock)"
          }
        }
      }
    },

    "/api/admin/overview": {
      "get": {
        "tags": ["Admin"],
        "summary": "Admin-only översikt",
        "responses": {
          "200": {
            "description": "Admin dashboard demo info"
          }
        }
      }
    },

    "/auth/signup": {
      "post": {
        "tags": ["Auth"],
        "summary": "Registrera en ny användare",
        "responses": {
          "201": {
            "description": "User created (demo)"
          }
        }
      },
      "get": {
        "tags": ["Auth"],
        "summary": "Info: denna endpoint ska egentligen vara POST",
        "responses": {
          "405": {
            "description": "Den här ska vara POST i riktig miljö"
          }
        }
      }
    },

    "/auth/login": {
      "post": {
        "tags": ["Auth"],
        "summary": "Logga in användare (mock)",
        "responses": {
          "200": {
            "description": "Returnerar fejkad JWT och user-info"
          }
        }
      },
      "get": {
        "tags": ["Auth"],
        "summary": "Info: denna endpoint ska egentligen vara POST",
        "responses": {
          "405": {
            "description": "Den här ska vara POST i riktig miljö"
          }
        }
      }
    },

    "/auth/logout": {
      "post": {
        "tags": ["Auth"],
        "summary": "Logga ut aktuell användare (mock)",
        "responses": {
          "200": {
            "description": "Utloggning klar"
          }
        }
      }
    },

    "/auth/me": {
      "get": {
        "tags": ["Auth"],
        "summary": "Hämta info om aktuell användare (mock)",
        "responses": {
          "200": {
            "description": "Fejkad user-info"
          }
        }
      }
    },

    "/auth/{id}": {
      "delete": {
        "tags": ["Auth"],
        "summary": "Radera användare (admin eller sig själv)",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "User deleted (mock)"
          }
        }
      }
    },

    "/api/companies": {
      "get": {
        "tags": ["Companies"],
        "summary": "Lista alla företag",
        "responses": {
          "200": {
            "description": "Array av företag"
          }
        }
      }
    },

    "/api/iot/sensors": {
      "get": {
        "tags": ["IoT"],
        "summary": "Lista alla sensorer",
        "responses": {
          "200": {
            "description": "Lista med sensorer"
          }
        }
      },
      "post": {
        "tags": ["IoT"],
        "summary": "Skicka in ett nytt sensorvärde",
        "requestBody": {
          "required": false
        },
        "responses": {
          "201": {
            "description": "Sparat (mock)"
          }
        }
      }
    },

    "/api/iot/sensors/{name}/{value}": {
      "get": {
        "tags": ["IoT"],
        "summary": "Kontrollera sensorvärde",
        "parameters": [
          {
            "name": "name",
            "in": "path",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "name": "value",
            "in": "path",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Returnerar vad du skickade in"
          }
        }
      }
    },

    "/api/telemetry": {
      "get": {
        "tags": ["IoT"],
        "summary": "Hämta telemetri från IoT-enheter (mockad backend)",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": { "type": "integer" },
            "description": "Max antal rader att returnera (t.ex. 10, 50, 100)"
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": { "type": "string", "enum": ["asc", "desc"] },
            "description": "asc = lägsta packet först, desc = högsta först"
          },
          {
            "name": "devicePrefix",
            "in": "query",
            "required": false,
            "schema": { "type": "string" },
            "description": "Filtrera på deviceId-prefix, t.ex. 'uno-r4-'"
          },
          {
            "name": "deviceId",
            "in": "query",
            "required": false,
            "schema": { "type": "string" },
            "description": "Exakt enhet, t.ex. 'uno-r4-055'"
          },
          {
            "name": "packet",
            "in": "query",
            "required": false,
            "schema": { "type": "integer" },
            "description": "Filtrera på ett specifikt paketnummer, t.ex. 3"
          },
          {
            "name": "packetFrom",
            "in": "query",
            "required": false,
            "schema": { "type": "integer" },
            "description": "Nedre gräns för paketintervall (inklusive)"
          },
          {
            "name": "packetTo",
            "in": "query",
            "required": false,
            "schema": { "type": "integer" },
            "description": "Övre gräns för paketintervall (inklusive)"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista av telemetrirader. Varje rad innehåller { deviceId, ts, temperature, humidity, packet, label }."
          }
        }
      }
    },

    "/api/packages": {
      "get": {
        "tags": ["Packages"],
        "summary": "Lista alla paket/enheter",
        "responses": {
          "200": {
            "description": "Lista av paket"
          }
        }
      }
    },

    "/api/users": {
      "get": {
        "tags": ["Users"],
        "summary": "Lista alla användare (safe view)",
        "responses": {
          "200": {
            "description": "Userlist (mock)"
          }
        }
      }
    },

    "/api/users/{id}": {
      "get": {
        "tags": ["Users"],
        "summary": "Hämta specifik användare",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "User object (mock)"
          }
        }
      }
    }
  }
}
